create database if not exists employee;
show databases;
use employee;
create table dept(deptno int,dname varchar(20),dloc varchar(20),primary key(deptno));
create table employee_details(empno int,ename varchar(20),mgrno varchar(10),hiredate date,sal int,deptno int,primary key(empno),foreign key(deptno) references dept(deptno));
create table project_info(pno int,ploc varchar(20),pname varchar(20),primary key(pno));
create table assigned_to_details(empno int,pno int(10),job_role varchar(20),foreign key(empno) references employee_details(empno),foreign key(pno) references project_info(pno));
create table incentives_details(empno int,incentive_date date,incentive_amount int,primary key(incentive_date),foreign key(empno) references employee_details(empno));
insert into dept values(1,'Monica','Banglore');
insert into dept values(2,'Chandler','Banglore');
insert into dept values(3,'Ross','Hyderabad');
insert into dept values(4,'Rachel','Mysore');
insert into dept values(5,'Joey','Tumkur');
insert into dept values(6,'Pheobe','Mysore');
insert into employee_details values(101,'Krishna','BC201','2003-10-12',15000,2);
insert into employee_details values(102,'Radha','BC202','2007-11-14',17000,3);
insert into employee_details values(103,'Soumya','BF204','2002-10-09',13000,1);
insert into employee_details values(104,'Deepa','BM208','2001-06-17',18000,3);
insert into employee_details values(105,'Ramya','BD206','2004-05-18',19000,4);
insert into employee_details values(106,'Keerti','BC301','2001-07-19',19500,5);
insert into project_info values(10,'Mysore','Rotaract');
insert into project_info values(11,'Banglore','Smriti');
insert into project_info values(12,'Pune','Sambharama');
insert into project_info values(13,'Tumkur','Kramp');
insert into project_info values(14,'Hyderabad','Smriti');
insert into project_info values(15,'Banglore','Panchayat');
insert into assigned_to_details values(102,12,'Designing');
insert into assigned_to_details values(103,11,'Marketing');
insert into assigned_to_details values(106,10,'SocialMedia');
insert into assigned_to_details values(105,15,'Testing');
insert into incentives_details values(102,'2004-05-17',12000);
insert into incentives_details values(104,'2002-03-16',15000);
insert into incentives_details values(106,'2001-04-16',18000);
insert into incentives_details values(103,'2008-11-21',19000);
select * from dept;
select * from employee_details;
select * from project_info;
select * from assigned_to_details;
select * from incentives_details;
SELECT e.ename AS manager_name FROM employee_details e WHERE e.empno IN (SELECT mgrno FROM employee_details GROUP BY mgrno HAVING COUNT(empno) = (SELECT MAX(emp_count) FROM (SELECT COUNT(empno) AS emp_count FROM employee_details GROUP BY mgrno) sub));
delete from employee_details where empno=107;
update employee_details set mgrno=101 where empno=101;
update employee_details set mgrno=103 where empno=102;
update employee_details set mgrno=104 where empno=104;
update employee_details set mgrno=105 where empno=106;
update employee_details set mgrno=111 where empno=105;
update employee_details set mgrno=190 where empno=103;
UPDATE EMPLOYEE_DETAILS SET MGRNO=101 WHERE EMPNO IN(101,102,104,105);
SELECT M.ENAME AS MANAGER_NAME FROM EMPLOYEE_DETAILS M JOIN EMPLOYEE_DETAILS E ON E.MGRNO=M.EMPNO GROUP BY M.EMPNO,M.ENAME,M.SAL HAVING M.SAL>AVG(E.SAL);
UPDATE employee_details SET sal = 20000 WHERE empno = 101;
UPDATE employee_details SET mgrno = NULL WHERE empno = 101;
UPDATE employee_details SET mgrno = 104 WHERE empno = 102;
UPDATE employee_details SET mgrno = 105 WHERE empno = 103;
UPDATE employee_details SET mgrno = 101 WHERE empno IN (104,105);
select ename as second_level_manager from employee_details e where e.mgrno in(select empno from employee_details where mgrno is NULL) and e.empno in(select distinct mgrno from employee_details where mgrno is not null);
SELECT * FROM incentives_details WHERE MONTH(incentive_date)=1 AND YEAR(incentive_date)=2019 AND incentive_amount=(SELECT MAX(incentive_amount) FROM incentives_details WHERE MONTH(incentive_date)=1 AND YEAR(incentive_date)=2019 AND incentive_amount<(SELECT MAX(incentive_amount) FROM incentives_details WHERE MONTH(incentive_date)=1 AND YEAR(incentive_date)=2019));

 

